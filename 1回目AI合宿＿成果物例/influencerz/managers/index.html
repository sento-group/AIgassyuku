<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>支社長データベース</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #DC143C;
            --primary-hover: #B22222;
            --success: #10b981;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgba(220, 20, 60, 0.1);
        }

        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #fff5f5 50%, #ffffff 100%);
            background-attachment: fixed;
            color: var(--text);
            scroll-behavior: smooth;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        /* ヘッダー */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-left {
            flex: 1;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .page-subtitle {
            color: var(--text-light);
            font-size: 14px;
        }

        /* ツールバー */
        .toolbar {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 14px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg);
        }

        /* テーブル */
        .table-container {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table thead {
            background: var(--bg);
        }

        .table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--text-light);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .table tbody tr {
            transition: background 0.2s;
            cursor: pointer;
        }

        .table tbody tr:hover {
            background: var(--bg);
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.registered {
            background: #d1fae5;
            color: #065f46;
        }

        .status-badge.unregistered {
            background: #f1f5f9;
            color: var(--text-light);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: var(--surface);
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-icon:hover {
            background: var(--bg);
            border-color: var(--primary);
            color: var(--primary);
        }

        /* モーダル */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--surface);
            border-radius: 12px;
            padding: 32px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            border: none;
            background: var(--bg);
            cursor: pointer;
            font-size: 20px;
            color: var(--text-light);
        }

        .close-btn:hover {
            background: var(--border);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--text);
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        .photo-preview-container {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .photo-preview-container img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }

        .photo-thumbnail {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        /* カードビュー */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .manager-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .manager-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(220, 20, 60, 0.2);
            border-color: #DC143C;
        }

        .manager-card-header {
            position: relative;
            height: 200px;
            background: linear-gradient(135deg, #DC143C 0%, #B22222 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .manager-card-header.has-photo {
            background: transparent;
            padding: 0;
        }

        .manager-card-header img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .manager-card-header .default-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 56px;
            color: white;
            border: 4px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .manager-card-body {
            padding: 20px;
        }

        .manager-card-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text);
            text-align: center;
        }

        .manager-card-prefecture {
            font-size: 14px;
            color: var(--text-light);
            text-align: center;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .manager-card-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .manager-card-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-light);
        }

        .manager-card-info-item i {
            width: 16px;
            color: var(--primary);
        }

        .manager-card-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .manager-card-actions .btn {
            flex: 1;
            padding: 8px 12px;
            font-size: 13px;
        }

        .skill-sheet-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: #fef3c7;
            color: #92400e;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin-top: 8px;
        }

        .empty-card {
            background: var(--bg);
            border: 2px dashed var(--border);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            color: var(--text-light);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .empty-card i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        .view-toggle {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .view-toggle-btn {
            padding: 8px 16px;
            border: 1px solid var(--border);
            background: var(--surface);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .view-toggle-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        @media (max-width: 768px) {
            .table-container {
                overflow-x: auto;
            }

            .toolbar {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <div class="header">
            <div class="header-left">
                <h1 class="page-title">支社長データベース</h1>
                <p class="page-subtitle">47都道府県の支社長情報を管理</p>
            </div>
            <div>
                <a href="../index.html" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> ダッシュボード
                </a>
            </div>
        </div>

        <!-- ツールバー -->
        <div class="toolbar">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="都道府県、名前、メールで検索..." oninput="filterTable()">
            </div>
            <button class="btn btn-primary" onclick="showAddModal()">
                <i class="fas fa-plus"></i> 新規追加
            </button>
            <button class="btn btn-secondary" onclick="showBulkImportModal()" style="background: var(--success); color: white; border: none;">
                <i class="fas fa-file-upload"></i> スキルシートから一括登録
            </button>
            <button class="btn btn-secondary" onclick="exportData()">
                <i class="fas fa-download"></i> エクスポート
            </button>
        </div>

        <!-- ビュー切り替え -->
        <div style="display: flex; gap: 8px; margin-bottom: 20px;">
            <button class="btn btn-secondary" id="cardViewBtn" onclick="switchView('card')" style="background: var(--primary); color: white;">
                <i class="fas fa-th-large"></i> カード表示
            </button>
            <button class="btn btn-secondary" id="tableViewBtn" onclick="switchView('table')">
                <i class="fas fa-table"></i> テーブル表示
            </button>
        </div>

        <!-- カードビュー -->
        <div id="cardView" class="card-view-container">
            <div class="cards-grid" id="cardsGrid">
                <!-- カードがここに動的に生成されます -->
            </div>
        </div>

        <!-- テーブルビュー -->
        <div id="tableView" class="table-container" style="display: none;">
            <table class="table">
                <thead>
                    <tr>
                        <th>都道府県</th>
                        <th>支社長名</th>
                        <th>連絡先</th>
                        <th>ステータス</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- データがここに動的に生成されます -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- 追加/編集モーダル -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">支社長情報を追加</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="managerForm">
                <div class="form-group">
                    <label class="form-label">都道府県 <span style="color: var(--danger);">*</span></label>
                    <select class="form-input" id="prefecture" required>
                        <option value="">選択してください</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">支社長名 <span style="color: var(--danger);">*</span></label>
                    <input type="text" class="form-input" id="name" required placeholder="例: 山田 太郎">
                </div>

                <div class="form-group">
                    <label class="form-label">メールアドレス</label>
                    <input type="email" class="form-input" id="email" placeholder="example@email.com">
                </div>

                <div class="form-group">
                    <label class="form-label">電話番号</label>
                    <input type="tel" class="form-input" id="phone" placeholder="090-1234-5678">
                </div>

                <div class="form-group">
                    <label class="form-label">経歴</label>
                    <textarea class="form-textarea" id="experience" placeholder="職歴、学歴などを記載"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">専門分野・スキル</label>
                    <textarea class="form-textarea" id="background" placeholder="専門分野、保有スキル、資格などを記載"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">実績</label>
                    <textarea class="form-textarea" id="achievements" placeholder="過去の実績、成功事例などを記載"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-camera"></i> 顔写真 <span style="color: #DC143C; font-size: 12px;">（推奨）</span>
                    </label>
                    <div style="margin-bottom: 12px;">
                        <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                        <div style="border: 2px dashed #DC143C; border-radius: 12px; padding: 20px; text-align: center; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%); cursor: pointer; transition: all 0.3s ease;" onclick="document.getElementById('photoInput').click()" onmouseover="this.style.background='linear-gradient(135deg, #fff0f0 0%, #fff5f5 100%)'; this.style.borderColor='#B22222';" onmouseout="this.style.background='linear-gradient(135deg, #fff5f5 0%, #ffffff 100%)'; this.style.borderColor='#DC143C';">
                            <i class="fas fa-camera" style="font-size: 32px; color: #DC143C; margin-bottom: 12px; display: block;"></i>
                            <div style="font-weight: 600; color: #DC143C; margin-bottom: 8px;">写真をアップロード</div>
                            <div style="font-size: 12px; color: #64748b;">クリックしてファイルを選択（JPG, PNG, 最大5MB）</div>
                        </div>
                        <div id="photoPreview" style="margin-top: 16px;"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">スキルシートPDF</label>
                    <select class="form-input" id="skillSheetFile">
                        <option value="">選択してください（該当する場合）</option>
                        <option value="久野　智大 - スキルシート.pdf">久野　智大 - スキルシート.pdf</option>
                        <option value="出雲静_クリエイター情報シート - スキルシート.pdf">出雲静_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="土方誠 - スキルシート.pdf">土方誠 - スキルシート.pdf</option>
                        <option value="奥田一輝_クリエイター情報シート - スキルシート.pdf">奥田一輝_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="守屋　光 - スキルシート.pdf">守屋　光 - スキルシート.pdf</option>
                        <option value="新城 拓馬_クリエイター情報シート - スキルシート.pdf">新城 拓馬_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="有光太_クリエイター情報シート - スキルシート.pdf">有光太_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="柏村翔_クリエイター情報シート - スキルシート.pdf">柏村翔_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="水上 智仁_クリエイター情報シート - スキルシート.pdf">水上 智仁_クリエイター情報シート - スキルシート.pdf</option>
                        <option value="淡路祐介_クリエイター情報シート - スキルシート.pdf">淡路祐介_クリエイター情報シート - スキルシート.pdf</option>
                    </select>
                    <p style="font-size: 12px; color: var(--text-light); margin-top: 4px;">
                        <i class="fas fa-info-circle"></i> スキルシートを選択すると、詳細情報を参照できます
                    </p>
                </div>

                <div class="form-group">
                    <label class="form-label">備考</label>
                    <textarea class="form-textarea" id="notes" placeholder="その他のメモ"></textarea>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> 保存
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">キャンセル</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 一括インポートモーダル -->
    <div class="modal" id="bulkImportModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-file-upload"></i> スキルシートから一括登録
                </h2>
                <button class="close-btn" onclick="closeBulkModal()">&times;</button>
            </div>
            
            <div style="margin-bottom: 20px; padding: 16px; background: var(--bg); border-radius: 8px;">
                <p style="font-size: 14px; color: var(--text-light); margin-bottom: 8px;">
                    <i class="fas fa-info-circle"></i> スキルシートフォルダに登録されている10名の支社長情報を一括で登録できます。
                </p>
                <p style="font-size: 13px; color: var(--text-light);">
                    各支社長に都道府県を割り当てて、一括で登録してください。
                </p>
            </div>

            <div style="max-height: 500px; overflow-y: auto; margin-bottom: 20px;">
                <table class="table" style="background: var(--surface);">
                    <thead>
                        <tr>
                            <th>名前</th>
                            <th>都道府県</th>
                            <th>スキルシート</th>
                            <th>ステータス</th>
                        </tr>
                    </thead>
                    <tbody id="bulkImportTable">
                        <!-- スキルシートのリストがここに生成されます -->
                    </tbody>
                </table>
            </div>
            
            <div style="margin-bottom: 20px; padding: 16px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px;">
                <p style="font-size: 13px; color: #856404; margin-bottom: 8px;">
                    <i class="fas fa-exclamation-circle"></i> <strong>重要:</strong> 一括登録後、各支社長の詳細情報（経歴、専門分野、実績、写真など）を編集画面から追加してください。
                </p>
                <p style="font-size: 12px; color: #856404;">
                    スキルシートPDFには詳細情報が記載されています。一括登録後、各支社長の「編集」ボタンから詳細情報と写真を追加できます。
                </p>
            </div>

            <div class="form-actions">
                <button class="btn btn-primary" onclick="bulkImportManagers()">
                    <i class="fas fa-save"></i> 一括登録
                </button>
                <button class="btn btn-secondary" onclick="closeBulkModal()">キャンセル</button>
            </div>
        </div>
    </div>

    <script>
        const prefectures = [
            "北海道", "青森県", "岩手県", "宮城県", "秋田県", "山形県", "福島県",
            "茨城県", "栃木県", "群馬県", "埼玉県", "千葉県", "東京都", "神奈川県", "新潟県",
            "富山県", "石川県", "福井県", "山梨県", "長野県", "岐阜県", "静岡県", "愛知県",
            "三重県", "滋賀県", "京都府", "大阪府", "兵庫県", "奈良県", "和歌山県",
            "鳥取県", "島根県", "岡山県", "広島県", "山口県", "徳島県", "香川県",
            "愛媛県", "高知県", "福岡県", "佐賀県", "長崎県", "熊本県", "大分県",
            "宮崎県", "鹿児島県", "沖縄県"
        ];

        let currentEditPrefecture = null;
        let currentPhotoData = null;

        // 写真アップロード処理
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                alert('画像ファイルを選択してください');
                return;
            }

            if (file.size > 5 * 1024 * 1024) {
                alert('画像サイズは5MB以下にしてください');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                currentPhotoData = e.target.result;
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `
                    <div style="background: linear-gradient(135deg, #ffffff 0%, #fff5f5 100%); border: 2px solid #DC143C; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(220, 20, 60, 0.1);">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div style="position: relative;">
                                <img src="${currentPhotoData}" style="width: 120px; height: 120px; object-fit: cover; border-radius: 12px; border: 3px solid #DC143C; box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);">
                                <div style="position: absolute; top: -5px; right: -5px; background: #DC143C; color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 12px; box-shadow: 0 2px 8px rgba(220, 20, 60, 0.3);">
                                    <i class="fas fa-check"></i>
                                </div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 700; color: #DC143C; margin-bottom: 8px; font-size: 16px;">
                                    <i class="fas fa-check-circle" style="margin-right: 6px;"></i>写真が選択されました
                                </div>
                                <div style="font-weight: 500; color: #2c3e50; margin-bottom: 4px;">${file.name}</div>
                                <div style="font-size: 12px; color: #64748b; margin-bottom: 12px;">${(file.size / 1024).toFixed(1)}KB</div>
                                <button type="button" class="btn btn-secondary" onclick="removePhoto()" style="background: #fff; border-color: #DC143C; color: #DC143C;">
                                    <i class="fas fa-times"></i> 写真を削除
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            };
            reader.readAsDataURL(file);
        }

        // 写真を削除
        function removePhoto() {
            currentPhotoData = null;
            document.getElementById('photoInput').value = '';
            document.getElementById('photoPreview').innerHTML = '';
        }

        // 初期化
        function init() {
            loadManagersData();
            populatePrefectureSelect();
            // 初期データを登録
            initializePresetData();
            displayCards();
        }

        // 初期データを登録
        function initializePresetData() {
            const presetData = {
                '北海道': { name: '出雲静', skill_sheet_file: '出雲静_クリエイター情報シート - スキルシート.pdf' },
                '福島県': { name: '柏村翔', skill_sheet_file: '柏村翔_クリエイター情報シート - スキルシート.pdf' },
                '神奈川県': { name: '土方誠', skill_sheet_file: '土方誠 - スキルシート.pdf' },
                '静岡県': { name: '守屋　光', skill_sheet_file: '守屋　光 - スキルシート.pdf' },
                '愛知県': { name: '久野　智大', skill_sheet_file: '久野　智大 - スキルシート.pdf' },
                '福岡県': { name: '奥田一輝', skill_sheet_file: '奥田一輝_クリエイター情報シート - スキルシート.pdf' },
                '高知県': { name: '有光太', skill_sheet_file: '有光太_クリエイター情報シート - スキルシート.pdf' },
                '沖縄県': { name: '新城 拓馬', skill_sheet_file: '新城 拓馬_クリエイター情報シート - スキルシート.pdf' }
            };

            const managers = loadManagersData();
            let updated = false;

            Object.keys(presetData).forEach(pref => {
                const preset = presetData[pref];
                // 既にデータがある場合は上書きしない
                if (!managers[pref] || !managers[pref].name) {
                    managers[pref] = {
                        name: preset.name,
                        contact_email: '',
                        contact_phone: '',
                        experience: `スキルシート: ${preset.skill_sheet_file}`,
                        background: '',
                        achievements: '',
                        notes: `スキルシートから登録: ${preset.skill_sheet_file}`,
                        skill_sheet_file: preset.skill_sheet_file,
                        photo: null
                    };
                    updated = true;
                }
            });

            if (updated) {
                localStorage.setItem('managersData', JSON.stringify(managers));
            }
        }

        // 都道府県選択リストを初期化
        function populatePrefectureSelect() {
            const select = document.getElementById('prefecture');
            prefectures.forEach(pref => {
                const option = document.createElement('option');
                option.value = pref;
                option.textContent = pref;
                select.appendChild(option);
            });
        }

        // データ読み込み
        function loadManagersData() {
            const saved = localStorage.getItem('managersData');
            return saved ? JSON.parse(saved) : {};
        }

        // ビュー切り替え
        let currentView = 'card';

        function switchView(view) {
            currentView = view;
            
            // ボタンの状態を更新
            document.getElementById('cardViewBtn').style.background = view === 'card' ? 'var(--primary)' : 'var(--surface)';
            document.getElementById('cardViewBtn').style.color = view === 'card' ? 'white' : 'var(--text)';
            document.getElementById('tableViewBtn').style.background = view === 'table' ? 'var(--primary)' : 'var(--surface)';
            document.getElementById('tableViewBtn').style.color = view === 'table' ? 'white' : 'var(--text)';
            
            // ビューの表示/非表示
            document.getElementById('cardView').style.display = view === 'card' ? 'block' : 'none';
            document.getElementById('tableView').style.display = view === 'table' ? 'block' : 'none';
            
            // 表示を更新
            if (view === 'card') {
                displayCards();
            } else {
                displayTable();
            }
        }

        // カード表示
        function displayCards() {
            const grid = document.getElementById('cardsGrid');
            const managers = loadManagersData();
            
            grid.innerHTML = '';

            prefectures.forEach(pref => {
                const manager = managers[pref] || {};
                const hasData = manager.name && manager.name.trim() !== '';
                
                const card = document.createElement('div');
                card.className = 'manager-card';
                card.setAttribute('data-prefecture', pref);
                
                if (hasData) {
                    card.innerHTML = `
                        <div class="manager-card-header ${manager.photo ? 'has-photo' : ''}" style="position: relative;">
                            ${manager.photo ? 
                                `<img src="${manager.photo}" alt="${manager.name}" style="width: 100%; height: 100%; object-fit: cover;">` :
                                `<div class="default-avatar">
                                    <i class="fas fa-user"></i>
                                </div>`
                            }
                            ${manager.photo ? '' : `
                                <div style="position: absolute; bottom: 10px; right: 10px; background: rgba(220, 20, 60, 0.9); color: white; padding: 4px 8px; border-radius: 6px; font-size: 10px; font-weight: 600; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);">
                                    <i class="fas fa-camera"></i> 写真未設定
                                </div>
                            `}
                        </div>
                        <div class="manager-card-body">
                            <div class="manager-card-name">${manager.name}</div>
                            <div class="manager-card-prefecture">${pref}</div>
                            <div class="manager-card-info">
                                ${manager.contact_email ? `
                                    <div class="manager-card-info-item">
                                        <i class="fas fa-envelope"></i>
                                        <span>${manager.contact_email}</span>
                                    </div>
                                ` : ''}
                                ${manager.contact_phone ? `
                                    <div class="manager-card-info-item">
                                        <i class="fas fa-phone"></i>
                                        <span>${manager.contact_phone}</span>
                                    </div>
                                ` : ''}
                                ${manager.skill_sheet_file ? `
                                    <div class="skill-sheet-badge">
                                        <i class="fas fa-file-pdf"></i>
                                        <span>スキルシートあり</span>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="manager-card-actions">
                                <button class="btn btn-primary" onclick="event.stopPropagation(); viewManager('${pref}')" style="flex: 1;">
                                    <i class="fas fa-eye"></i> 詳細
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); editManager('${pref}')" style="flex: 1;">
                                    <i class="fas fa-edit"></i> 編集
                                </button>
                            </div>
                        </div>
                    `;
                } else {
                    card.innerHTML = `
                        <div class="manager-card-header">
                            <div class="default-avatar" style="background: rgba(0, 0, 0, 0.05);">
                                <i class="fas fa-user-plus" style="color: var(--text-light);"></i>
                            </div>
                        </div>
                        <div class="manager-card-body">
                            <div class="manager-card-name" style="color: var(--text-light);">未登録</div>
                            <div class="manager-card-prefecture">${pref}</div>
                            <div class="manager-card-actions">
                                <button class="btn btn-primary" onclick="event.stopPropagation(); showAddModal('${pref}')" style="width: 100%;">
                                    <i class="fas fa-plus"></i> 登録する
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                grid.appendChild(card);
            });
        }

        // テーブル表示
        function displayTable() {
            const tbody = document.getElementById('tableBody');
            const managers = loadManagersData();
            
            tbody.innerHTML = '';

            if (Object.keys(managers).length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>データがありません。新規追加ボタンから登録してください。</p>
                        </td>
                    </tr>
                `;
                return;
            }

            prefectures.forEach(pref => {
                const manager = managers[pref] || {};
                const hasData = manager.name && manager.name.trim() !== '';
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td><strong>${pref}</strong></td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            ${manager.photo ? `<img src="${manager.photo}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%; border: 2px solid #DC143C; box-shadow: 0 2px 8px rgba(220, 20, 60, 0.2);">` : `<div style="width: 50px; height: 50px; background: linear-gradient(135deg, #DC143C 0%, #B22222 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; box-shadow: 0 2px 8px rgba(220, 20, 60, 0.2);"><i class="fas fa-user"></i></div>`}
                            <div>
                                <div style="font-weight: 500;">${hasData ? manager.name : '<span style="color: var(--text-light);">未登録</span>'}</div>
                                ${manager.skill_sheet_file ? `<div style="font-size: 11px; color: var(--text-light); margin-top: 2px;"><i class="fas fa-file-pdf"></i> ${manager.skill_sheet_file}</div>` : ''}
                            </div>
                        </div>
                    </td>
                    <td>
                        ${manager.contact_email ? `<div style="font-size: 13px; color: var(--text-light);"><i class="fas fa-envelope"></i> ${manager.contact_email}</div>` : ''}
                        ${manager.contact_phone ? `<div style="font-size: 13px; color: var(--text-light);"><i class="fas fa-phone"></i> ${manager.contact_phone}</div>` : ''}
                        ${!hasData ? '<span style="color: var(--text-light);">-</span>' : ''}
                    </td>
                    <td>
                        <span class="status-badge ${hasData ? 'registered' : 'unregistered'}">
                            <i class="fas ${hasData ? 'fa-check-circle' : 'fa-circle'}"></i>
                            ${hasData ? '登録済み' : '未登録'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon" onclick="editManager('${pref}')" title="編集">
                                <i class="fas fa-edit"></i>
                            </button>
                            ${hasData ? `<button class="btn-icon" onclick="viewManager('${pref}')" title="詳細">
                                <i class="fas fa-eye"></i>
                            </button>` : ''}
                        </div>
                    </td>
                `;
                
                row.setAttribute('data-prefecture', pref);
                tbody.appendChild(row);
            });
        }

        // 検索フィルター
        function filterTable() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            
            if (currentView === 'card') {
                const cards = document.querySelectorAll('.manager-card');
                cards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    card.style.display = text.includes(search) ? '' : 'none';
                });
            } else {
                const rows = document.querySelectorAll('#tableBody tr');
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(search) ? '' : 'none';
                });
            }
        }

        // モーダル表示
        function showAddModal(pref = null) {
            currentEditPrefecture = pref;
            const modal = document.getElementById('addModal');
            const title = document.getElementById('modalTitle');
            
            if (pref) {
                title.textContent = `${pref} の支社長情報を編集`;
                document.getElementById('prefecture').value = pref;
                loadManagerData(pref);
            } else {
                title.textContent = '支社長情報を追加';
                document.getElementById('managerForm').reset();
                document.getElementById('prefecture').value = '';
            }
            
            modal.classList.add('active');
        }

        // モーダルを閉じる
        function closeModal() {
            document.getElementById('addModal').classList.remove('active');
            document.getElementById('managerForm').reset();
            currentEditPrefecture = null;
            currentPhotoData = null;
            document.getElementById('photoPreview').innerHTML = '';
            document.getElementById('photoInput').value = '';
        }

        // 編集
        function editManager(pref) {
            showAddModal(pref);
        }

        // 詳細表示
        function viewManager(pref) {
            const managers = loadManagersData();
            const manager = managers[pref] || {};
            
            // 詳細モーダルを表示
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px;">
                    <div class="modal-header">
                        <h2 class="modal-title">${pref} 支社長情報</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div style="max-height: 70vh; overflow-y: auto;">
                        ${manager.photo ? `
                            <div style="text-align: center; margin-bottom: 24px;">
                                <div style="position: relative; display: inline-block;">
                                    <img src="${manager.photo}" style="max-width: 250px; max-height: 250px; width: 250px; height: 250px; object-fit: cover; border-radius: 50%; border: 4px solid #DC143C; box-shadow: 0 8px 25px rgba(220, 20, 60, 0.3);">
                                    <div style="position: absolute; bottom: 10px; right: 10px; background: #DC143C; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(220, 20, 60, 0.4);">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                            </div>
                        ` : `
                            <div style="text-align: center; margin-bottom: 24px; padding: 40px; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%); border: 2px dashed #DC143C; border-radius: 12px;">
                                <i class="fas fa-user-circle" style="font-size: 80px; color: #DC143C; opacity: 0.3; margin-bottom: 12px;"></i>
                                <div style="color: #DC143C; font-weight: 600; font-size: 14px;">写真が未設定です</div>
                                <div style="color: #64748b; font-size: 12px; margin-top: 4px;">編集画面から写真を追加できます</div>
                            </div>
                        `}
                        <div class="form-group">
                            <label class="form-label">名前</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px;">${manager.name || '未登録'}</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">メールアドレス</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px;">${manager.contact_email || '未登録'}</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">電話番号</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px;">${manager.contact_phone || '未登録'}</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">経歴</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px; min-height: 60px; white-space: pre-wrap;">${manager.experience || '未登録'}</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">専門分野・スキル</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px; min-height: 60px; white-space: pre-wrap;">${manager.background || '未登録'}</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">実績</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px; min-height: 60px; white-space: pre-wrap;">${manager.achievements || '未登録'}</div>
                        </div>
                        ${manager.skill_sheet_file ? `
                            <div class="form-group">
                                <label class="form-label">スキルシート</label>
                                <div style="padding: 10px; background: var(--bg); border-radius: 6px;">
                                    <i class="fas fa-file-pdf"></i> ${manager.skill_sheet_file}
                                </div>
                            </div>
                        ` : ''}
                        <div class="form-group">
                            <label class="form-label">備考</label>
                            <div style="padding: 10px; background: var(--bg); border-radius: 6px; min-height: 60px; white-space: pre-wrap;">${manager.notes || '未登録'}</div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="editManager('${pref}'); this.closest('.modal').remove();">
                            <i class="fas fa-edit"></i> 編集
                        </button>
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">閉じる</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // データ読み込み
        function loadManagerData(pref) {
            const managers = loadManagersData();
            const manager = managers[pref] || {};
            
            document.getElementById('prefecture').value = pref;
            document.getElementById('name').value = manager.name || '';
            document.getElementById('email').value = manager.contact_email || '';
            document.getElementById('phone').value = manager.contact_phone || '';
            document.getElementById('experience').value = manager.experience || '';
            document.getElementById('background').value = manager.background || '';
            document.getElementById('achievements').value = manager.achievements || '';
            document.getElementById('notes').value = manager.notes || '';
            document.getElementById('skillSheetFile').value = manager.skill_sheet_file || '';
            
            // 写真を読み込み
            if (manager.photo) {
                currentPhotoData = manager.photo;
                const preview = document.getElementById('photoPreview');
                preview.innerHTML = `
                    <div style="background: linear-gradient(135deg, #ffffff 0%, #fff5f5 100%); border: 2px solid #DC143C; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(220, 20, 60, 0.1);">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div style="position: relative;">
                                <img src="${currentPhotoData}" style="width: 120px; height: 120px; object-fit: cover; border-radius: 12px; border: 3px solid #DC143C; box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);">
                                <div style="position: absolute; top: -5px; right: -5px; background: #DC143C; color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 12px; box-shadow: 0 2px 8px rgba(220, 20, 60, 0.3);">
                                    <i class="fas fa-check"></i>
                                </div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 700; color: #DC143C; margin-bottom: 8px; font-size: 16px;">
                                    <i class="fas fa-check-circle" style="margin-right: 6px;"></i>登録済みの写真
                                </div>
                                <div style="font-size: 12px; color: #64748b; margin-bottom: 12px;">新しい写真を選択すると上書きされます</div>
                                <button type="button" class="btn btn-secondary" onclick="removePhoto()" style="background: #fff; border-color: #DC143C; color: #DC143C;">
                                    <i class="fas fa-times"></i> 写真を削除
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                currentPhotoData = null;
                document.getElementById('photoPreview').innerHTML = '';
            }
        }

        // フォーム送信
        document.getElementById('managerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const prefecture = document.getElementById('prefecture').value;
            const data = {
                name: document.getElementById('name').value,
                contact_email: document.getElementById('email').value,
                contact_phone: document.getElementById('phone').value,
                experience: document.getElementById('experience').value,
                background: document.getElementById('background').value,
                achievements: document.getElementById('achievements').value,
                notes: document.getElementById('notes').value,
                skill_sheet_file: document.getElementById('skillSheetFile').value,
                photo: currentPhotoData || null
            };

            const managers = loadManagersData();
            managers[prefecture] = data;
            localStorage.setItem('managersData', JSON.stringify(managers));
            
            // 現在のビューに応じて表示を更新
            if (currentView === 'card') {
                displayCards();
            } else {
                displayTable();
            }
            closeModal();
            alert('保存しました！');
        });

        // エクスポート
        function exportData() {
            const data = loadManagersData();
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `支社長データ_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
        }

        // スキルシート一覧
        const skillSheets = [
            { name: "久野　智大", filename: "久野　智大 - スキルシート.pdf" },
            { name: "出雲静", filename: "出雲静_クリエイター情報シート - スキルシート.pdf" },
            { name: "土方誠", filename: "土方誠 - スキルシート.pdf" },
            { name: "奥田一輝", filename: "奥田一輝_クリエイター情報シート - スキルシート.pdf" },
            { name: "守屋　光", filename: "守屋　光 - スキルシート.pdf" },
            { name: "新城 拓馬", filename: "新城 拓馬_クリエイター情報シート - スキルシート.pdf" },
            { name: "有光太", filename: "有光太_クリエイター情報シート - スキルシート.pdf" },
            { name: "柏村翔", filename: "柏村翔_クリエイター情報シート - スキルシート.pdf" },
            { name: "水上 智仁", filename: "水上 智仁_クリエイター情報シート - スキルシート.pdf" },
            { name: "淡路祐介", filename: "淡路祐介_クリエイター情報シート - スキルシート.pdf" }
        ];

        // 一括インポートモーダル表示
        function showBulkImportModal() {
            const modal = document.getElementById('bulkImportModal');
            const tbody = document.getElementById('bulkImportTable');
            
            tbody.innerHTML = '';
            
            skillSheets.forEach((sheet, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${sheet.name}</strong></td>
                    <td>
                        <select class="form-input" id="bulkPrefecture_${index}" style="width: 200px; padding: 8px;">
                            <option value="">未選択</option>
                        </select>
                    </td>
                    <td>
                        <div style="font-size: 12px; color: var(--text-light);">
                            <i class="fas fa-file-pdf"></i> ${sheet.filename}
                        </div>
                    </td>
                    <td>
                        <span class="status-badge unregistered" id="bulkStatus_${index}">
                            <i class="fas fa-circle"></i> 未登録
                        </span>
                    </td>
                `;
                tbody.appendChild(row);
                
                // 都道府県選択リストを追加
                const select = document.getElementById(`bulkPrefecture_${index}`);
                prefectures.forEach(pref => {
                    const option = document.createElement('option');
                    option.value = pref;
                    option.textContent = pref;
                    select.appendChild(option);
                });
                
                // 変更時にステータス更新
                select.addEventListener('change', function() {
                    const statusBadge = document.getElementById(`bulkStatus_${index}`);
                    if (this.value) {
                        statusBadge.className = 'status-badge registered';
                        statusBadge.innerHTML = '<i class="fas fa-check-circle"></i> 登録準備完了';
                    } else {
                        statusBadge.className = 'status-badge unregistered';
                        statusBadge.innerHTML = '<i class="fas fa-circle"></i> 未登録';
                    }
                });
            });
            
            modal.classList.add('active');
        }

        // 一括インポートモーダルを閉じる
        function closeBulkModal() {
            document.getElementById('bulkImportModal').classList.remove('active');
        }

        // 一括登録実行
        function bulkImportManagers() {
            const managers = loadManagersData();
            let importedCount = 0;
            let skippedCount = 0;
            
            skillSheets.forEach((sheet, index) => {
                const select = document.getElementById(`bulkPrefecture_${index}`);
                const prefecture = select.value;
                
                if (!prefecture) {
                    skippedCount++;
                    return;
                }
                
                // 既に登録されている場合は確認
                if (managers[prefecture] && managers[prefecture].name) {
                    if (!confirm(`${prefecture}には既に「${managers[prefecture].name}」が登録されています。上書きしますか？`)) {
                        skippedCount++;
                        return;
                    }
                }
                
                // データを登録
                managers[prefecture] = {
                    name: sheet.name,
                    contact_email: '',
                    contact_phone: '',
                    experience: `スキルシート: ${sheet.filename}`,
                    background: '',
                    achievements: '',
                    notes: `スキルシートから一括登録: ${sheet.filename}`,
                    skill_sheet_file: sheet.filename,
                    photo: null
                };
                
                importedCount++;
            });
            
            if (importedCount === 0) {
                alert('登録するデータがありません。都道府県を選択してください。');
                return;
            }
            
            // 保存
            localStorage.setItem('managersData', JSON.stringify(managers));
            
            // 現在のビューに応じて表示を更新
            if (currentView === 'card') {
                displayCards();
            } else {
                displayTable();
            }
            
            // モーダルを閉じる
            closeBulkModal();
            
            alert(`${importedCount}名の支社長情報を登録しました！${skippedCount > 0 ? `（${skippedCount}名をスキップ）` : ''}\n\n各支社長の「編集」ボタンから詳細情報と写真を追加してください。`);
        }

        // 初期化
        init();
    </script>
</body>
</html>
